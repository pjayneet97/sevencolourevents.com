(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"4ro/":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n("fXoL"),i=n("ofXK"),s=n("TEn/");function c(e,t){if(1&e&&o.Qb(0,"ion-icon",5),2&e){const e=o.hc();o.pc("name",e.icon)}}function a(e,t){if(1&e&&o.Qb(0,"img",6),2&e){const e=o.hc();o.pc("src",e.image,o.Bc)("width",e.imageWidth)}}let r=(()=>{class e{constructor(){this.text="",this.icon="alert",this.image="",this.imageWidth=""}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Jb({type:e,selectors:[["empty-view"]],inputs:{text:"text",icon:"icon",image:"image",imageWidth:"imageWidth"},decls:6,vars:3,consts:[[1,"container"],[3,"name",4,"ngIf"],[3,"src","width",4,"ngIf"],["color","medium"],[1,"bold"],[3,"name"],[3,"src","width"]],template:function(e,t){1&e&&(o.Vb(0,"div",0),o.Fc(1,c,1,1,"ion-icon",1),o.Fc(2,a,1,2,"img",2),o.Vb(3,"ion-text",3),o.Vb(4,"p",4),o.Hc(5),o.Ub(),o.Ub(),o.Ub()),2&e&&(o.Cb(1),o.pc("ngIf",!t.image),o.Cb(1),o.pc("ngIf",t.image),o.Cb(3),o.Ic(t.text))},directives:[i.l,s.S,s.r],styles:["[_nghost-%COMP%]{position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;text-align:center;height:100%}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px}"]}),e})()},CP0t:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n("d2mR"),i=n("3Pt+"),s=n("fXoL");let c=(()=>{class e{}return e.\u0275mod=s.Nb({type:e}),e.\u0275inj=s.Mb({factory:function(t){return new(t||e)},imports:[[o.a,i.f,i.l]]}),e})()},"X0/9":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n("v0iw"),i=n("fXoL");let s=(()=>{class e extends o.Object{constructor(){super("CustomerAddress")}create(t={}){return(new e).save(t)}load(){const t=new o.Query(e);return t.include(["zone","subzone"]),t.equalTo("customer",o.User.current()),t.descending("createdAt"),t.find()}get address(){return this.get("address")}set address(e){this.set("address",e)}get zone(){return this.get("zone")}set zone(e){this.set("zone",e)}get subzone(){return this.get("subzone")}set subzone(e){this.set("subzone",e)}get city(){return this.get("city")}set city(e){this.set("city",e)}get zipcode(){return this.get("zipcode")}set zipcode(e){this.set("zipcode",e)}get name(){return this.get("name")}set name(e){this.set("name",e)}get phone(){return this.get("phone")}set phone(e){this.set("phone",e)}get location(){return this.get("location")}set location(e){this.set("location",e)}toString(){return`${this.address}, ${this.city}, ${this.subzone.name}, ${this.zipcode}, ${this.zone.name}`}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();o.Object.registerSubclass("CustomerAddress",s)},s5X5:function(e,t,n){"use strict";var o=n("mrSG"),i=n("3Pt+"),s=n("NV1z"),c=n("X0/9"),a=n("v0iw"),r=n("fXoL");let l=(()=>{class e extends a.Object{constructor(){super("Zone")}load(t={}){const n=new a.Query(e);return t.type&&n.equalTo("type",t.type),t.parent&&n.equalTo("parent",t.parent),n.ascending("sort"),n.equalTo("isActive",!0),n.doesNotExist("deletedAt"),n.find()}get name(){return this.get("name")}get fee(){return this.get("fee")}toString(){return this.name}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();a.Object.registerSubclass("Zone",l);var b=n("TEn/"),d=n("eIep"),u=n("lJxs"),p=n("LRne"),m=n("Bfh1"),h=n("AytR");const g=["map"];let f=(()=>{class e{constructor(e,t){this.modalCtrl=e,this.renderer=t,this.center={lat:-34.397,lng:150.644},this.selectable=!0,this.closeButtonText="Cancel",this.title="Pick Location"}ngOnInit(){}ngAfterViewInit(){this.getGoogleMaps().then(e=>{this.googleMaps=e;const t=this.mapElementRef.nativeElement,n=new e.Map(t,{center:this.center,zoom:16});this.googleMaps.event.addListenerOnce(n,"idle",()=>{this.renderer.addClass(t,"visible")}),this.selectable?this.clickListener=n.addListener("click",e=>{const t={lat:e.latLng.lat(),lng:e.latLng.lng()};this.modalCtrl.dismiss(t)}):new e.Marker({position:this.center,map:n,title:"Picked Location"}).setMap(n)}).catch(e=>{console.log(e)})}onCancel(){this.modalCtrl.dismiss()}ngOnDestroy(){this.clickListener&&this.googleMaps.event.removeListener(this.clickListener)}getGoogleMaps(){const e=window,t=e.google;return t&&t.maps?Promise.resolve(t.maps):new Promise((t,n)=>{const o=document.createElement("script");o.src="https://maps.googleapis.com/maps/api/js?key="+h.a.googleMapsAPIKey,o.async=!0,o.defer=!0,document.body.appendChild(o),o.onload=()=>{const o=e.google;o&&o.maps?t(o.maps):n("Google maps SDK not available.")}})}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(b.cb),r.Pb(r.E))},e.\u0275cmp=r.Jb({type:e,selectors:[["app-map-modal"]],viewQuery:function(e,t){var n;1&e&&r.Nc(g,!0),2&e&&r.wc(n=r.ec())&&(t.mapElementRef=n.first)},inputs:{center:"center",selectable:"selectable",closeButtonText:"closeButtonText",title:"title"},decls:10,vars:2,consts:[["slot","primary"],[3,"click"],[1,"map"],["map",""]],template:function(e,t){1&e&&(r.Vb(0,"ion-header"),r.Vb(1,"ion-toolbar"),r.Vb(2,"ion-title"),r.Hc(3),r.Ub(),r.Vb(4,"ion-buttons",0),r.Vb(5,"ion-button",1),r.dc("click",(function(){return t.onCancel()})),r.Hc(6),r.Ub(),r.Ub(),r.Ub(),r.Ub(),r.Vb(7,"ion-content"),r.Qb(8,"div",2,3),r.Ub()),2&e&&(r.Cb(3),r.Ic(t.title),r.Cb(3),r.Ic(t.closeButtonText))},directives:[b.q,b.X,b.V,b.k,b.j,b.n],styles:[".map[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;background-color:transparent;opacity:0;-webkit-transition:opacity .15s ease-in;transition:opacity .15s ease-in}.map.visible[_ngcontent-%COMP%]{opacity:1}"]}),e})();var C=n("tk/3"),w=n("ofXK");function y(e,t){1&e&&r.Qb(0,"ion-spinner",4)}function V(e,t){if(1&e){const e=r.Wb();r.Vb(0,"ion-img",5),r.dc("click",(function(){return r.yc(e),r.hc().onPickLocation()})),r.Ub()}if(2&e){const e=r.hc();r.pc("src",e.selectedLocationImage)}}function v(e,t){if(1&e){const e=r.Wb();r.Vb(0,"ion-button",6),r.dc("click",(function(){return r.yc(e),r.hc().onPickLocation()})),r.Qb(1,"ion-icon",7),r.Vb(2,"ion-label"),r.Hc(3,"Select location"),r.Ub(),r.Ub()}}let k=(()=>{class e{constructor(e,t,n,o,i){this.modalCtrl=e,this.http=t,this.actionSheetCtrl=n,this.alertCtrl=o,this.geolocation=i,this.locationPick=new r.n,this.isLoading=!1}ngOnInit(){}onPickLocation(){this.actionSheetCtrl.create({header:"Please Choose",buttons:[{text:"Auto-Locate",handler:()=>{this.locateUser()}},{text:"Pick on Map",handler:()=>{this.openMap()}},{text:"Cancel",role:"cancel"}]}).then(e=>{e.present()})}locateUser(){this.isLoading=!0,this.geolocation.getCurrentPosition().then(e=>{const t={lat:e.coords.latitude,lng:e.coords.longitude};this.createPlace(t.lat,t.lng),this.isLoading=!1}).catch(e=>{this.isLoading=!1,this.showErrorAlert()})}showErrorAlert(){this.alertCtrl.create({header:"Could not fetch location",message:"Please use the map to pick a location!",buttons:["Okay"]}).then(e=>e.present())}openMap(){this.modalCtrl.create({component:f}).then(e=>{e.onDidDismiss().then(e=>{if(!e.data)return;const t={lat:e.data.lat,lng:e.data.lng};this.createPlace(t.lat,t.lng)}),e.present()})}createPlace(e,t){const n={lat:e,lng:t,address:null,staticMapImageUrl:null};this.isLoading=!0,this.getAddress(e,t).pipe(Object(d.a)(e=>(n.address=e,Object(p.a)(this.getMapImage(n.lat,n.lng,14))))).subscribe(e=>{n.staticMapImageUrl=e,this.selectedLocationImage=e,this.isLoading=!1,this.locationPick.emit(n)})}getAddress(e,t){return this.http.get(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${e},${t}&key=${h.a.googleMapsAPIKey}`).pipe(Object(u.a)(e=>e&&e.results&&0!==e.results.length?e.results[0].formatted_address:null))}getMapImage(e,t,n){return`https://maps.googleapis.com/maps/api/staticmap?center=${e},${t}&zoom=${n}&size=500x300&maptype=roadmap\n    &markers=color:red%7Clabel:Place%7C${e},${t}\n    &key=${h.a.googleMapsAPIKey}`}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(b.cb),r.Pb(C.b),r.Pb(b.a),r.Pb(b.b),r.Pb(m.a))},e.\u0275cmp=r.Jb({type:e,selectors:[["app-location-picker"]],outputs:{locationPick:"locationPick"},decls:4,vars:3,consts:[[1,"picker"],["color","danger",4,"ngIf"],["role","button","class","location-image",3,"src","click",4,"ngIf"],["size","medium","shape","undefined","color","undefined","fill","clear","class","my-auto text-uppercase shadow-sm mr-2 ion-button",3,"click",4,"ngIf"],["color","danger"],["role","button",1,"location-image",3,"src","click"],["size","medium","shape","undefined","color","undefined","fill","clear",1,"my-auto","text-uppercase","shadow-sm","mr-2","ion-button",3,"click"],["name","location-outline","slot","start"]],template:function(e,t){1&e&&(r.Vb(0,"div",0),r.Fc(1,y,1,0,"ion-spinner",1),r.Fc(2,V,1,1,"ion-img",2),r.Fc(3,v,4,0,"ion-button",3),r.Ub()),2&e&&(r.Cb(1),r.pc("ngIf",t.isLoading),r.Cb(1),r.pc("ngIf",t.selectedLocationImage&&!t.isLoading),r.Cb(1),r.pc("ngIf",!t.selectedLocationImage&&!t.isLoading))},directives:[w.l,b.O,b.s,b.j,b.r,b.y],styles:[".picker[_ngcontent-%COMP%]{width:30rem;max-width:80%;height:10rem;max-height:50vh;display:-webkit-box;display:flex;-webkit-box-pack:left;justify-content:left;-webkit-box-align:left;align-items:left}.location-image[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}"]}),e})();var U=n("sYmb");function P(e,t){if(1&e&&(r.Vb(0,"ion-select-option",25),r.Hc(1),r.Ub()),2&e){const e=t.$implicit;r.pc("value",e),r.Cb(1),r.Jc(" ",e.name," ")}}function I(e,t){if(1&e&&(r.Vb(0,"ion-select-option",25),r.Hc(1),r.Ub()),2&e){const e=t.$implicit;r.pc("value",e),r.Cb(1),r.Jc(" ",e.name," ")}}n.d(t,"a",(function(){return z}));let z=(()=>{class e extends s.a{constructor(e,t,n){super(e),this.zoneService=t,this.customerAddressService=n,this.zones=[],this.subzones=[]}ngOnInit(){this.setupForm()}enableMenuSwipe(){return!1}ionViewDidEnter(){this.loadZones()}setupForm(){this.form=new i.d({zone:new i.b(null,i.m.required),subzone:new i.b(null,i.m.required),city:new i.b("",i.m.required),zipcode:new i.b("",i.m.required),address:new i.b("",i.m.required),name:new i.b("",i.m.required),phone:new i.b("",i.m.required),location:new i.b(null)})}onDismiss(e=null){this.modalCtrl.dismiss(e)}loadZones(){return Object(o.a)(this,void 0,void 0,(function*(){try{this.zones=yield this.zoneService.load({type:"Parent"})}catch(e){console.warn(e.message)}}))}onZoneChanged(){return Object(o.a)(this,void 0,void 0,(function*(){try{this.form.controls.subzone.setValue(null),this.subzones=yield this.zoneService.load({parent:this.form.value.zone})}catch(e){console.warn(e.message)}}))}onSubmit(){return Object(o.a)(this,void 0,void 0,(function*(){if(this.form.invalid)return this.translate.get("INVALID_FORM").subscribe(e=>this.showToast(e));try{yield this.showLoadingView({showOverlay:!1});const e=Object.assign({},this.form.value),t=yield this.customerAddressService.create(e);this.showContentView(),this.onDismiss(t)}catch(e){this.showContentView(),this.translate.get("ERROR_NETWORK").subscribe(e=>this.showToast(e))}}))}onLocationPick(e){console.log(e),this.form.patchValue({location:e}),this.form.patchValue({address:e.address})}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(r.r),r.Pb(l),r.Pb(c.a))},e.\u0275cmp=r.Jb({type:e,selectors:[["page-address-add"]],features:[r.zb],decls:72,vars:36,consts:[[1,"ion-no-border","border-bottom"],["slot","start"],["fill","clear",3,"click"],["name","close"],[1,"ion-padding"],["color","dark"],[1,"bold","ion-no-margin"],[1,"line"],["novalidate","",3,"formGroup","ngSubmit"],["form1","ngForm"],["lines","none"],["position","stacked","color","medium"],[1,"bold"],[3,"locationPick"],["lines","none","color","light",1,"ion-margin-vertical"],["formControlName","zone",3,"ionChange"],["color","danger",3,"value",4,"ngFor","ngForOf"],["formControlName","subzone"],["type","text","formControlName","city"],["type","number","formControlName","zipcode"],["rows","4","formControlName","address"],["type","text","formControlName","name"],["type","number","formControlName","phone"],[1,"ion-text-center"],["type","submit","size","medium","shape","undefined","color","undefined","fill","clear","expand","block",1,"my-auto","text-uppercase","shadow-sm","mr-2","ion-button"],["color","danger",3,"value"]],template:function(e,t){1&e&&(r.Vb(0,"ion-header",0),r.Vb(1,"ion-toolbar"),r.Vb(2,"ion-buttons",1),r.Vb(3,"ion-button",2),r.dc("click",(function(){return t.onDismiss()})),r.Qb(4,"ion-icon",3),r.Ub(),r.Ub(),r.Ub(),r.Ub(),r.Vb(5,"ion-content",4),r.Vb(6,"ion-text",5),r.Vb(7,"h4",6),r.Hc(8),r.ic(9,"translate"),r.Ub(),r.Qb(10,"div",7),r.Ub(),r.Vb(11,"form",8,9),r.dc("ngSubmit",(function(){return t.onSubmit()})),r.Vb(13,"ion-list",10),r.Vb(14,"ion-label",11),r.Vb(15,"span",12),r.Hc(16,"Select Location"),r.Ub(),r.Ub(),r.Vb(17,"app-location-picker",13),r.dc("locationPick",(function(e){return t.onLocationPick(e)})),r.Ub(),r.Vb(18,"ion-label",11),r.Vb(19,"span",12),r.Hc(20),r.ic(21,"translate"),r.Ub(),r.Ub(),r.Vb(22,"ion-item",14),r.Vb(23,"ion-label"),r.Hc(24),r.ic(25,"translate"),r.Ub(),r.Vb(26,"ion-select",15),r.dc("ionChange",(function(){return t.onZoneChanged()})),r.Fc(27,P,2,2,"ion-select-option",16),r.Ub(),r.Ub(),r.Vb(28,"ion-label",11),r.Vb(29,"span",12),r.Hc(30),r.ic(31,"translate"),r.Ub(),r.Ub(),r.Vb(32,"ion-item",14),r.Vb(33,"ion-label"),r.Hc(34),r.ic(35,"translate"),r.Ub(),r.Vb(36,"ion-select",17),r.Fc(37,I,2,2,"ion-select-option",16),r.Ub(),r.Ub(),r.Vb(38,"ion-label",11),r.Vb(39,"span",12),r.Hc(40),r.ic(41,"translate"),r.Ub(),r.Ub(),r.Vb(42,"ion-item",14),r.Qb(43,"ion-input",18),r.Ub(),r.Vb(44,"ion-label",11),r.Vb(45,"span",12),r.Hc(46),r.ic(47,"translate"),r.Ub(),r.Ub(),r.Vb(48,"ion-item",14),r.Qb(49,"ion-input",19),r.Ub(),r.Vb(50,"ion-label",11),r.Vb(51,"span",12),r.Hc(52),r.ic(53,"translate"),r.Ub(),r.Ub(),r.Vb(54,"ion-item",14),r.Qb(55,"ion-textarea",20),r.Ub(),r.Vb(56,"ion-label",11),r.Vb(57,"span",12),r.Hc(58),r.ic(59,"translate"),r.Ub(),r.Ub(),r.Vb(60,"ion-item",14),r.Qb(61,"ion-input",21),r.Ub(),r.Vb(62,"ion-label",11),r.Vb(63,"span",12),r.Hc(64),r.ic(65,"translate"),r.Ub(),r.Ub(),r.Vb(66,"ion-item",14),r.Qb(67,"ion-input",22),r.Ub(),r.Vb(68,"div",23),r.Vb(69,"ion-button",24),r.Hc(70),r.ic(71,"translate"),r.Ub(),r.Ub(),r.Ub(),r.Ub(),r.Ub()),2&e&&(r.Cb(8),r.Jc(" ",r.jc(9,14,"SHIPPING_INFO")," "),r.Cb(3),r.pc("formGroup",t.form),r.Cb(9),r.Ic(r.jc(21,16,"ZONE")),r.Cb(4),r.Ic(r.jc(25,18,"ZONE")),r.Cb(3),r.pc("ngForOf",t.zones),r.Cb(3),r.Ic(r.jc(31,20,"SUBZONE")),r.Cb(4),r.Ic(r.jc(35,22,"SUBZONE")),r.Cb(3),r.pc("ngForOf",t.subzones),r.Cb(3),r.Ic(r.jc(41,24,"CITY")),r.Cb(6),r.Ic(r.jc(47,26,"ZIPCODE")),r.Cb(6),r.Ic(r.jc(53,28,"SHIPPING_ADDRESS")),r.Cb(6),r.Ic(r.jc(59,30,"CONTACT_NAME")),r.Cb(6),r.Ic(r.jc(65,32,"CONTACT_PHONE")),r.Cb(6),r.Jc(" ",r.jc(71,34,"SAVE")," "))},directives:[b.q,b.X,b.k,b.j,b.r,b.n,b.S,i.n,i.j,i.e,b.z,b.y,k,b.w,b.K,b.ib,i.i,i.c,w.k,b.v,b.jb,b.eb,b.T,b.L],pipes:[U.c],styles:[""]}),e})()}}]);